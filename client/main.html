<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Main â€¢ ëŒ€ì‹œë³´ë“œ</title>
  <style>
    :root{
      --bg:#0b1224;
      --fg:#e5e7eb;
      --muted:#94a3b8;
      --card:#0f172acc;
      --border:#1f2a44;
      --ring:#7dd3fc;
      --primary:#60a5fa;
      --tile:#111a33cc;
      --tile-hover:#162244cc;
    }
    @media (prefers-color-scheme: light){
      :root{
        --bg:#f8fafc;
        --fg:#0f172a;
        --muted:#64748b;
        --card:#ffffffcc;
        --border:#e2e8f0;
        --ring:#2563eb;
        --primary:#3b82f6;
        --tile:#ffffffcc;
        --tile-hover:#f1f5f9cc;
      }
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, 'Noto Sans KR', Helvetica, Arial;
      color:var(--fg);
      background:
        radial-gradient(1100px 600px at 15% 10%, #1e293b50, transparent 60%),
        radial-gradient(900px 500px at 85% 20%, #312e8155, transparent 60%),
        radial-gradient(900px 500px at 50% 100%, #0ea5e955, transparent 60%),
        var(--bg);
      display:flex; flex-direction:column;
    }

    /* í—¤ë” */
    header{
      display:flex; align-items:center; justify-content:space-between;
      padding:14px 18px;
    }
    .brand{
      display:flex; align-items:center; gap:10px; user-select:none;
    }
    .logo{
      width:34px; height:34px; border-radius:9px;
      background: linear-gradient(135deg,#60a5fa,#8b5cf6);
      display:grid; place-items:center; color:white; font-weight:800; letter-spacing:.2px;
      box-shadow:0 6px 18px rgba(99,102,241,.35);
    }
    .brand span{ font-weight:700 }

    .actions{
      display:flex; align-items:center; gap:10px;
    }
    .avatar{
      width:36px; height:36px; border-radius:50%; background:#1f2a44; color:#cbd5e1;
      display:grid; place-items:center; font-weight:800; cursor:pointer; border:1px solid var(--border);
      transition:box-shadow .2s;
    }
    .avatar:focus-visible{ outline:2px solid var(--ring); outline-offset:2px }
    .menu{
      position:absolute; right:18px; top:60px; width:220px; background:var(--card);
      border:1px solid var(--border); border-radius:12px; padding:8px; display:none; backdrop-filter: blur(10px);
      box-shadow:0 20px 50px rgba(0,0,0,.35);
    }
    .menu.show{ display:block }
    .menu .email{ padding:10px; color:var(--muted); font-size:.9rem; border-bottom:1px solid var(--border) }
    .menu a{
      display:flex; align-items:center; gap:10px; padding:10px; border-radius:10px; text-decoration:none; color:var(--fg);
    }
    .menu a:hover{ background:var(--tile-hover) }

    /* ë©”ì¸ ì˜ì—­ */
    main{
      flex:1;
      display:flex; flex-direction:column;
      align-items:center; justify-content:flex-start;
      padding:28px 16px 40px;
      gap:22px;
    }

    /* ê²€ìƒ‰/ì±—ë´‡ ë°” (í¬ë¡¬ ê²€ìƒ‰ì°½ ëŠë‚Œ) */
    .search-wrap{
      width:100%; max-width:750px;
      display:flex; flex-direction:column; align-items:center; gap:12px;
      margin-top:30px;
    }
    .search{
      width:100%; display:flex; align-items:center; gap:10px;
      background:var(--card); border:1px solid var(--border); border-radius:24px; padding:10px 14px;
      box-shadow:0 14px 40px rgba(0,0,0,.25); backdrop-filter: blur(10px);
    }
    .search input{
      flex:1; border:none; background:transparent; color:var(--fg); outline:none; font-size:1.05rem;
    }
    .search button{
      border:none; border-radius:18px; padding:10px 14px; cursor:pointer; color:white; background:var(--primary);
      font-weight:700;
    }
    .greeting{ color:var(--muted); font-size:.95rem }

    /* íƒ€ì¼ ê·¸ë¦¬ë“œ (í¬ë¡¬ ë°”ë¡œê°€ê¸° íƒ€ì¼ ëŠë‚Œ) */
    .tiles{
      display:grid; grid-template-columns: repeat(4, minmax(140px, 1fr));
      gap:18px; width:100%; max-width:940px; margin-top:6px;
    }
    @media (max-width:900px){
      .tiles{ grid-template-columns: repeat(2,minmax(140px,1fr)); }
    }
    @media (max-width:520px){
      .tiles{ grid-template-columns: 1fr; }
    }

    .tile{
      position:relative;
      background:var(--tile); border:1px solid var(--border); border-radius:18px; padding:16px;
      text-decoration:none; color:var(--fg); display:flex; align-items:center; gap:14px;
      transition: transform .06s ease, background .2s, box-shadow .2s;
      backdrop-filter: blur(10px);
    }
    .tile:hover{ transform: translateY(-2px); background:var(--tile-hover); box-shadow:0 16px 36px rgba(0,0,0,.28) }
    .tile .icon{
      width:42px; height:42px; border-radius:12px; display:grid; place-items:center;
      background:linear-gradient(135deg,#38bdf8,#818cf8);
      box-shadow:0 10px 22px rgba(56,189,248,.35);
    }
    .tile h3{ margin:0; font-size:1.05rem }
    .tile p{ margin:2px 0 0 0; color:var(--muted); font-size:.9rem }

    footer{
      text-align:center; color:var(--muted); font-size:.85rem; padding:18px;
    }

    /* ìˆ¨ê¹€ í…ìŠ¤íŠ¸ ì ‘ê·¼ì„± */
    .sr-only{ position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); border:0 }
  </style>
</head>
<body>
  <header>
    <div class="brand">
      <div class="logo" aria-hidden="true">GN</div>
      <span>ê·€ë† ì²­ë…„</span>
    </div>

    <div class="actions">
      <div id="avatar" class="avatar" tabindex="0" aria-haspopup="true" aria-expanded="false" title="í”„ë¡œí•„ ë° ì„¤ì •">U</div>
      <nav id="menu" class="menu" aria-label="ì‚¬ìš©ì ë©”ë‰´">
        <div class="email" id="userEmailLabel">ë¡œê·¸ì¸ ì •ë³´ ì—†ìŒ</div>
        <a href="profile.html" id="profileLink">ğŸ§‘â€ğŸ”§ í”„ë¡œí•„ ì—…ë°ì´íŠ¸</a>
        <a href="settings.html">âš™ï¸ ì„¤ì •</a>
        <a href="/logout" id="logoutLink">ğŸšª ë¡œê·¸ì•„ì›ƒ</a>
      </nav>
    </div>
  </header>

  <main>
    <!-- ê²€ìƒ‰/ì±—ë´‡ ë°” -->
    <section class="search-wrap" aria-labelledby="searchTitle">
      <h1 id="searchTitle" class="sr-only">ì±—ë´‡ ê²€ìƒ‰</h1>
      <form class="search" id="chatSearch" role="search" action="/chat" method="GET">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true">
          <path d="M21 21l-4.2-4.2M10.5 18a7.5 7.5 0 1 1 0-15 7.5 7.5 0 0 1 0 15Z"
                stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
        <input type="search" name="q" id="q" placeholder="ë¬´ì—‡ì´ë“  ë¬¼ì–´ë³´ì„¸ìš”â€¦ (ì˜ˆ: ì¼ì • ì¶”ê°€, ì¶”ì²œ ì‘ë¬¼, ì •ì±… ì§€ì›ê¸ˆ)" autocomplete="off" />
        <button type="submit">ì§ˆë¬¸í•˜ê¸°</button>
      </form>
      <div class="greeting" id="greeting">í™˜ì˜í•©ë‹ˆë‹¤!</div>
    </section>

    <!-- íƒ€ì¼ ë²„íŠ¼ ì˜ì—­ -->
    <section class="tiles" aria-label="ë¹ ë¥¸ ì‹¤í–‰">
      <!-- ì¶”ì²œì‹œìŠ¤í…œ -->
      <a class="tile" href="recommend.html" aria-label="ì¶”ì²œì‹œìŠ¤í…œ ì—´ê¸°">
        <div class="icon" aria-hidden="true">
          <svg width="22" height="22" viewBox="0 0 24 24" fill="none">
            <path d="M4 4h16v6H4V4Zm0 10h10v6H4v-6Zm12 0h4v6h-4v-6Z" stroke="currentColor" stroke-width="2" />
          </svg>
        </div>
        <div>
          <h3>ì¶”ì²œì‹œìŠ¤í…œ</h3>
          <p>ì‘ë¬¼/ì¥ë¹„/êµìœ¡ ì½”ìŠ¤ ê°œì¸í™” ì¶”ì²œ</p>
        </div>
      </a>

      <!-- ì¼ì •ê´€ë¦¬ -->
      <a class="tile" href="calendar.html" aria-label="ì¼ì •ê´€ë¦¬ ì—´ê¸°">
        <div class="icon" aria-hidden="true">
          <svg width="22" height="22" viewBox="0 0 24 24" fill="none">
            <path d="M7 2v4M17 2v4M3 9h18M5 6h14a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2Z"
                  stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </div>
        <div>
          <h3>ì¼ì •ê´€ë¦¬</h3>
          <p>íŒŒì¢…Â·ìˆ˜í™•Â·êµìœ¡ ì¼ì • í•œëˆˆì—</p>
        </div>
      </a>

      <!-- ì •ì±… ì •ë³´ -->
      <a class="tile" href="policy.html" aria-label="ì •ì±… ì •ë³´ ì—´ê¸°">
        <div class="icon" aria-hidden="true">
          <svg width="22" height="22" viewBox="0 0 24 24" fill="none">
            <path d="M4 6h16M6 10h12M8 14h8M10 18h4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </div>
        <div>
          <h3>ì •ì±… ì •ë³´</h3>
          <p>ì§€ì›ê¸ˆÂ·êµìœ¡Â·ì„ëŒ€ ì •ë³´ ëª¨ì•„ë³´ê¸°</p>
        </div>
      </a>

      <!-- (ì„ íƒ) ë°ì´í„° ì—…ë¡œë“œ / ê·¸ ì™¸ ê¸°ëŠ¥ -->
      <a class="tile" href="/more" aria-label="ì¶”ê°€ê¸°ëŠ¥ ì—´ê¸°">
        <div class="icon" aria-hidden="true">
          <svg width="22" height="22" viewBox="0 0 24 24" fill="none">
            <path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </div>
        <div>
          <h3>ë” ë³´ê¸°</h3>
          <p>íŒŒì¼ ì—…ë¡œë“œ, ë¦¬í¬íŠ¸, ì„¤ì • ë“±</p>
        </div>
      </a>
    </section>
  </main>

  <footer>Â© <span id="year"></span> ê·€ë† ì²­ë…„ ì—ì´ì „íŠ¸</footer>

  <script>
    // â¬‡ï¸ ë¡œê·¸ì¸ í˜ì´ì§€ì—ì„œ ì €ì¥í•œ ì‚¬ìš©ì ì •ë³´ ì½ê¸°
    const email = sessionStorage.getItem('userEmail') || '';
    const nameFromEmail = email ? email.split('@')[0] : '';
    const avatar = document.getElementById('avatar');
    const menu = document.getElementById('menu');
    const userEmailLabel = document.getElementById('userEmailLabel');
    const greeting = document.getElementById('greeting');

    // ì—°ë„
    document.getElementById('year').textContent = new Date().getFullYear();

    // ì•„ë°”íƒ€ ì´ë‹ˆì…œ & íˆ´íŒ, ì´ë©”ì¼ ë¼ë²¨
    if(email){
      userEmailLabel.textContent = email;
      avatar.title = email + ' â€¢ í”„ë¡œí•„ ë° ì„¤ì •';
      const initial = (nameFromEmail[0] || 'U').toUpperCase();
      avatar.textContent = initial;
      greeting.textContent = `ì•ˆë…•í•˜ì„¸ìš”, ${nameFromEmail}ë‹˜! ë¬´ì—‡ì„ ë„ì™€ë“œë¦´ê¹Œìš”?`;
    } else {
      avatar.textContent = 'U';
      greeting.textContent = 'í™˜ì˜í•©ë‹ˆë‹¤! ë¡œê·¸ì¸ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆì–´ìš”.';
    }

    // ì•„ë°”íƒ€ í´ë¦­/í‚¤ë³´ë“œë¡œ ë©”ë‰´ í† ê¸€
    function toggleMenu(show) {
      const isShow = show ?? !menu.classList.contains('show');
      menu.classList.toggle('show', isShow);
      avatar.setAttribute('aria-expanded', String(isShow));
    }
    avatar.addEventListener('click', () => toggleMenu());
    avatar.addEventListener('keydown', (e) => {
      if(e.key === 'Enter' || e.key === ' ') { e.preventDefault(); toggleMenu(); }
      if(e.key === 'Escape'){ toggleMenu(false); }
    });
    document.addEventListener('click', (e) => {
      if(!menu.contains(e.target) && e.target !== avatar){ toggleMenu(false); }
    });

    // ì±—ë´‡ ê²€ìƒ‰ ì œì¶œ ì‹œ /chat?q=... ë¡œ ì´ë™ (ê¸°ë³¸ actionë„ /chat)
    document.getElementById('chatSearch').addEventListener('submit', (e) => {
      const q = document.getElementById('q').value.trim();
      if(!q){ e.preventDefault(); document.getElementById('q').focus(); }
    });

    // ë¡œê·¸ì•„ì›ƒ í´ë¦­ ì‹œ ì„¸ì…˜ ì •ë¦¬ (ë¼ìš°íŒ…ì€ ì„œë²„ì— ë§ê²Œ)
    document.getElementById('logoutLink').addEventListener('click', (e) => {
      sessionStorage.clear();
    });

    // í”„ë¡œí•„ ì—…ë°ì´íŠ¸ ë¼ìš°íŠ¸ ì˜ˆì‹œ (ì›í•˜ë©´ ì¿¼ë¦¬ë¡œ ì´ë©”ì¼ ì „ë‹¬)
    document.getElementById('profileLink').addEventListener('click', (e) => {
      if(email){ e.currentTarget.href = `/profile?email=${encodeURIComponent(email)}`; }
    });
  </script>
</body>
</html>
